<!DOCTYPE html>
<html>
    <head>
        <title>Companion Canyon</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <link href="https://fonts.googleapis.com/css?family=Baloo|Roboto" rel="stylesheet">
    </head>
    <body>
        <div class="container content">
            <h1 class="mx-2">Survey</h1>
            <p class="mx-2">Truthfully answer the following questions.</p> 
            <p class="mx-2">Consider 1 as "Absolutely Not" and 5 as "Guilty as Charged".</p>

            <form class="mx-2">
                <h4>About You</h4>
                <div class="form-group">
                    <input id="name" type="text" class="form-control" placeholder="Name (Required)">
                </div>
                <div class="form-group">
                    <input id="photo" type="text" class="form-control" placeholder="Link to Profile Photo (Required)">
                </div>
                <div class="form-group">
                    <h4>Question 1</h4>
                    <label for="question1">Pineapples go on pizza.</label>
                    <select class="form-control" id="question1">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 2</h4>
                    <label for="question2">Cereal before milk.</label>
                    <select class="form-control" id="question2">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 3</h4>
                    <label for="question3">"It's pronounced JIF."</label>
                    <select class="form-control" id="question3">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 4</h4>
                    <label for="question4">Toilet paper rolls over.</label>
                    <select class="form-control" id="question4">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 5</h4>
                    <label for="question5">Steak medium-rare.</label>
                    <select class="form-control" id="question5">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 6</h4>
                    <label for="question6">Sriracha on everything.</label>
                    <select class="form-control" id="question6">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 7</h4>
                    <label for="question7">Tacos over fried chicken.</label>
                    <select class="form-control" id="question7">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 8</h4>
                    <label for="question8">The book was better.</label>
                    <select class="form-control" id="question8">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 9</h4>
                    <label for="question9">PC games over console games.</label>
                    <select class="form-control" id="question9">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <h4>Question 10</h4>
                    <label for="question10">Goku is better than Superman.</label>
                    <select class="form-control" id="question10">
                        <option value="empty"></option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
            </form>
            <div class="text-center">
                <button id="submitBtn" type="submit" class="btn btn-success btn-lg">Submit</button>
            </div>

        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    </body>
</html>

<!-- Logic to store user's information and survey responses -->
<script type="text/javascript">
	$("#submitBtn").on("click", function(event) {
        event.preventDefault();
        
		// Form validation
		var valid = true;
		if($("#name").val() === "" || $("#photo").val() === "") {
			valid = false;
        } else if($("#question1").val() === "empty" || $("#question2").val() === "empty" || 
        $("#question3").val() === "empty" || $("#question4").val() === "empty" || 
        $("#question5").val() === "empty" || $("#question6").val() === "empty" || 
        $("#question7").val() === "empty" || $("#question8").val() === "empty" || 
        $("#question9").val() === "empty" || $("#question10").val() === "empty") {
			valid = false;
		}
		if(valid === true) {
			var newUser = {
				name: $("#name").val().trim(),
				photo: $("#photo").val().trim(),
				scores: [
					$("#question1").val(),
					$("#question2").val(),
					$("#question3").val(),
					$("#question4").val(),
					$("#question5").val(),
					$("#question6").val(),
					$("#question7").val(),
					$("#question8").val(),
					$("#question9").val(),
					$("#question10").val()
				]
			};
            var currentURL = window.location.origin;
            
			// AJAX for receiving response after POST req
			$.post(currentURL + "/api/friends", newUser, function(data) {
				$("#companion").text(data.name);
				$("#companionPhoto").attr("src", data.photo);
				$("#companionModal").modal("toggle");
			});
		} else {
			// Show alert if required field is missing
			alert("Survey is incomplete!");
		}
	});
</script>